(define-syntax allow-pred
  (syntax-rules ()
    ((_ type vars ...)
     (begin
       (eval '(define type (list 'vars ...)) (interaction environment))
       (eval (list 'define (list (string-append (symbol->string 'type) "?") 'object)
                   '(and (list? object) (equal? (car object) type))) (interaction-environment))))))
(define-syntax define-data
  (syntax-rules ()
    ((_ type ((var arg ...) ...))
        (begin
          (allow-pred type var ...)
          (allow-constr var arg ...) ...))))
  